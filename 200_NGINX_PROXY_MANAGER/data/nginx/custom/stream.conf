map $ssl_preread_server_name $backend {
    eturnal.landingdev.xyz eturnal_tls;
    default eturnal_tls;
}
upstream eturnal_tls {
    server 10.10.20.10:5349;
}
upstream eturnal_tcp {
    server 10.10.20.10:3478;
}
upstream eturnal_udp {
    server 10.10.20.10:3478;
}
upstream eturnal_tcp_5348 {
    server 10.10.20.10:5348;
}
server {
    listen 5349;
    listen [::]:5349;
    ssl_preread on;
    proxy_pass $backend;
    proxy_timeout 3s;
    proxy_connect_timeout 30s;
}
server {
    listen 3478;
    listen [::]:3478;
    proxy_pass eturnal_tcp;
    proxy_timeout 3s;
    proxy_connect_timeout 30s;
}
server {
    listen 3478 udp;
    listen [::]:3478 udp;
    proxy_pass eturnal_udp;
    proxy_timeout 3s;
    proxy_connect_timeout 30s;
}
server {
    listen 5348;
    listen [::]:5348;
    proxy_pass eturnal_tcp_5348;
    proxy_timeout 3s;
    proxy_connect_timeout 30s;
}
