export LIVEKIT_URL=https://live.landingdev.xyz
export LIVEKIT_API_KEY=Nm7MFqEdn7dEkLW
export LIVEKIT_API_SECRET=cpCc17rcrz9TpfG7b0xD2ImsPAMF2P8GP3aqBqlsNLNG

echo ""
echo ""
echo "LIVEKIT_URL=$LIVEKIT_URL"
echo "LIVEKIT_API_KEY=$LIVEKIT_API_KEY"
echo "LIVEKIT_API_SECRET=$LIVEKIT_API_SECRET"
echo ""
echo ""
echo "VERIFY WITH LIVEKIT.YAML" 
cat ../livekit.yaml | tail -n 2
echo ""
echo ""

# ./lk create-token \
#   --api-key $LIVEKIT_API_KEY \
#   --api-secret $LIVEKIT_API_SECRET \
#   --identity test-user \
#   --room test-room \
#   --join \
#   --valid-for 24h
    

export lk_token=$(./lk create-token --api-key $LIVEKIT_API_KEY --api-secret $LIVEKIT_API_SECRET --identity test-user --room test-room --join --valid-for 24h | grep "Access token:" | awk '{print $3}')

# Check if token is captured
if [ -z "$lk_token" ]; then
  echo ""
  echo "Error: Failed to capture lk_token"
  echo ""
else
  echo ""
  echo "lk_token=$lk_token"
  echo ""
fi


echo "### LIVEKIT TESTER URL"
echo "wss://live.landingdev.xyz"
echo ""
echo "export LIVEKIT_URL=$LIVEKIT_URL"
echo "export LIVEKIT_API_KEY=$LIVEKIT_API_KEY"
echo "export LIVEKIT_API_SECRET=$LIVEKIT_API_SECRET"
echo "export lk_token=$lk_token"
